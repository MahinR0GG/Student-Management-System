<div class="teacher-dashboard-layout">

  <!-- ‚úÖ Top Right Logout -->
  <div class="top-nav">
    <button class="logout-btn" (click)="logout()">
      <span class="material-icons">logout</span>
      Logout
    </button>
  </div>

  <!-- ‚úÖ Sidebar -->
  <div class="teacher-sidebar">
    
    <div class="sidebar-header">
      <h3>Subject Teacher</h3>

      <!-- ‚úÖ Manage Classes Dropdown under title -->
      <label>Select Class:</label>
      <select [(ngModel)]="currentClass" (change)="switchClass($any($event.target).value)">
        <option *ngFor="let c of classList" [value]="c">{{ c }}</option>
      </select>
    </div>
    
    <ul class="sidebar-nav">
      <li>
        <a (click)="setView('overview')" [class.active]="currentView === 'overview'">
          üìä Dashboard Overview
        </a>
      </li>

      <li>
        <a (click)="setView('marks')" [class.active]="currentView === 'marks'">
          üìù Exam Marks Entry
        </a>
      </li>

      <li>
        <a (click)="setView('assignments')" [class.active]="currentView === 'assignments'">
          üßë‚Äçüéì Manage Assignments
        </a>
      </li>

      <li>
        <a (click)="setView('resources')" [class.active]="currentView === 'resources'">
          üìö Upload Resources
        </a>
      </li>
    </ul>

      <li>
        <a (click)="setView('profile')" [class.active]="currentView === 'profile'">
        üë§ My Profile
       </a>
    </li>


  </div>

  <!-- ‚úÖ Content Area -->
  <div class="teacher-content-area">

    <!-- ‚úÖ Overview -->
    <div *ngIf="currentView === 'overview'">
      <div class="dashboard-header">
        <h1>{{ subjectName }} Dashboard ({{ currentClass }})</h1>
        <p>Welcome, {{ teacherName }} (Subject Teacher)</p>
      </div>

      <div class="kpi-section">
        <div class="kpi-card"><h3>Total Students</h3><p>{{ totalStudents }}</p></div>
        <div class="kpi-card"><h3>Pending Assignments</h3><p>{{ pendingAssignments }}</p></div>
        <div class="kpi-card"><h3>Class Average</h3><p>{{ averageMarks }}%</p></div>
      </div>
    </div>

            <!-- üëâ My Profile View -->
    <div *ngIf="currentView === 'profile'" class="profile-panel">
      <h2>üë§ My Profile</h2>

      <div class="profile-row"><strong>Name:</strong> {{ teacherProfile.name }}</div>
      <div class="profile-row"><strong>Email:</strong> {{ teacherProfile.email }}</div>
      <div class="profile-row"><strong>Phone:</strong> {{ teacherProfile.phone }}</div>
      <div class="profile-row"><strong>Role:</strong> {{ teacherProfile.role }}</div>

      <div *ngIf="teacherProfile.classInCharge">
        <div class="profile-row"><strong>Class In-Charge:</strong> {{ teacherProfile.classInCharge }}</div>
      </div>

      <div class="profile-row"><strong>Subjects:</strong> {{ teacherProfile.subjects.join(', ') }}</div>

      <hr>

      <h3>Leave Summary</h3>
      <div class="profile-row"><strong>Total Leaves:</strong> {{ teacherProfile.totalLeaves }}</div>
      <div class="profile-row"><strong>Used:</strong> {{ teacherProfile.usedLeaves }}</div>
      <div class="profile-row"><strong>Remaining:</strong> {{ teacherProfile.totalLeaves - teacherProfile.usedLeaves }}</div>
    </div>

    <!-- ‚úÖ Marks Entry -->
    <div *ngIf="currentView === 'marks'">
      <div class="exam-overview-panel">

        <h2>Exam Marks Entry ({{ currentClass }})</h2>

        <div class="exam-filter">
          <label>Select Exam Type:</label>

          <div class="exam-dropdown" [class.open]="isDropdownOpen" (click)="toggleDropdown()">
            <div class="selected-exam">
              <span class="exam-tag">{{ selectedExam }}</span>
              <span class="arrow" [class.open]="isDropdownOpen">&#9662;</span>
            </div>

            <ul class="exam-options" *ngIf="isDropdownOpen">
              <li *ngFor="let exam of examTypes"
                  [class.active]="exam === selectedExam"
                  (click)="selectExam(exam)">
                {{ exam }}
              </li>
            </ul>
          </div>
        </div>

        <table class="exam-table">
          <thead>
            <tr>
              <th>Roll No</th>
              <th>Name</th>
              <th>Assignment Marks</th>
              <th>{{ selectedExam }} Marks</th>
              <th>Update</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let s of students">
              <td>{{ s.rollNo }}</td>
              <td>{{ s.name }}</td>

              <td>
                <input type="number" class="marks-input" [(ngModel)]="s.assignmentMarks" min="0" max="100">
              </td>

              <td>
                <input type="number" class="marks-input" [(ngModel)]="s.examMarks" min="0" max="100">
              </td>

              <td>
                <button class="approve-btn" (click)="updateMarks(s)">Save</button>
              </td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>

    <!-- ‚úÖ Assignments -->
    <div *ngIf="currentView === 'assignments'">
      <div class="event-management-panel">
        
        <h2>Assignments ({{ currentClass }})</h2>

        <div class="attendance-controls">
          <input type="text" [(ngModel)]="newAssignment.title" placeholder="Assignment Title">
          <input type="date" [(ngModel)]="newAssignment.dueDate">
          <input type="text" [(ngModel)]="newAssignment.description" placeholder="Description...">
          <button (click)="addAssignment()">Add Assignment</button>
        </div>

        <table class="leave-table">
          <thead>
            <tr>
              <th>Title</th>
              <th>Due Date</th>
              <th>Description</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let a of assignments">
              <td>{{ a.title }}</td>
              <td>{{ a.dueDate | date }}</td>
              <td>{{ a.description }}</td>
              <td>{{ a.status }}</td>

              <td>
                <button class="approve-btn" (click)="editAssignment(a)">Edit</button>
                <button class="reject-btn" (click)="deleteAssignment(a)">Delete</button>
              </td>
            </tr>
          </tbody>

        </table>

      </div>
    </div>

    <!-- ‚úÖ Resources -->
    <div *ngIf="currentView === 'resources'">
      <div class="student-roster">

        <h2>Teaching Resources ({{ currentClass }})</h2>

        <div class="attendance-controls">
          <input type="text" [(ngModel)]="newResource.title" placeholder="Resource Title">
          <input type="url" [(ngModel)]="newResource.link" placeholder="Resource Link">
          <button (click)="addResource()">Add Resource</button>
        </div>

        <table class="leave-table">
          <thead>
            <tr><th>Title</th><th>Link</th></tr>
          </thead>
          <tbody>
            <tr *ngFor="let r of resources">
              <td>{{ r.title }}</td>
              <td><a [href]="r.link" target="_blank">{{ r.link }}</a></td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>

  </div>
</div>
